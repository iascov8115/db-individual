# Индивидуальная работа "Поставки товаров"

## Проектирование базы данных

1. Анализ экономической деятельности децентрализованной организации из конкретной области реального мира
2. Схема географического распределения децентрализованных подразделений
3. Проектирование локальных баз данных на каждом узле
4. Планирование необходимых фрагментов объектов

---

## Настройка распределенной среды

1. Создайте как минимум два экземпляра PostgreSQL, запущенных в контейнерах Docker (например, db_master, db_slave1 и db_slave2)
2. Убедитесь, что экземпляры могут видеть друг друга
3. Если у вас есть проект Java/Maven, интегрируйте Flyway в pom.xml, или альтернативно запустите Flyway из CLI для выполнения скриптов миграции

---

## Скрипты миграции

1. Создайте пользователя, под которым будет работать Flyway
2. Создайте скрипты для создания таблиц в схеме app
3. Создайте процедуры для вставки тестовых данных в эти таблицы. В качестве параметра эти процедуры будут получать количество записей для вставки

---

## Фрагментация данных

1. Разделите большую таблицу на несколько фрагментов по определенному критерию (географический регион, временной интервал, тип клиента)

---

## Репликация базы данных

1. Настройте репликацию между узлами
2. Объясните, почему вы выбрали данную модель репликации, и продемонстрируйте, что она наиболее подходит для данной области

---

## Распределенные транзакции

1. Продемонстрируйте атомарную транзакцию, которая изменяет два разных узла базы данных

---

## Data Warehouse и ETL

1. Создайте новую схему dwh для записи истории данных
2. В этих таблицах DWH будут храниться исходные поля вместе со столбцами аудита (valid_from, valid_to, is_active)
3. Создайте процедуру, которая будет обнаруживать изменения в схеме app и применять их в DWH
    - Идентифицирует новые, измененные или удаленные строки
    - Вставляет новые и обновленные строки с valid_from = CURRENT_TIMESTAMP, valid_to = NULL, is_active = true
    - Для существующих в DWH строк, где значения изменились по сравнению с источником — устанавливает старую версию как устаревшую valid_to = CURRENT_TIMESTAMP, is_active = false, затем вставляет новую запись с новыми значениями
    - Если в DWH существует запись с is_active = true, которая больше не появляется в APP, это значит, что она была удалена, и устанавливается valid_to = CURRENT_TIMESTAMP, is_active = false

---